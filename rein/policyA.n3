# USAGE : cwm --n3 requestA.n3 engine.n3 --think --filter="engine.n3"

@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix reina: <reinA.n3#>.
@prefix rein: <rein.n3#>.
@prefix ont: <ontA.n3#>.
@prefix reind: <reinD.n3#>.
@prefix ontd: <ontD.n3#>.
@prefix : <#>.

<>  a reina:Policy;
  reina:modalitydef reina:PositiveMod;
  rein:usesOntology <reinA.n3>.

# All Scientists who work on the QNProject are allowed to use the QuantumNetwork
@forAll :x.
{  ?x a ont:Scientist. 
   ont:QNProject ont:inproject ?x
} => { ?x reina:ispermitted ont:UseQuantumNetwork }.

# All managers are permitted to use all services on fax machines
@forAll :x, :y, :z.
{  ?x a ont:Manager. 
   ?y a ont:Service. 
   ?y ont:target ?z. 
   ?z a ont:Fax
} => { ?x reina:ispermitted ?y }.

# if a projectmanager x is permitted (by policyD) to execute ontd:File2
# then x is permitted to use all Fax services
@forAll :x, :y, :z, :F, :G.
{  :x a ont:ProjectManager.
   # create a request object for using with engine.n3
   ( {[] a rein:Request; rein:requester :x;
         rein:requestedAction ontd:File2; rein:requestType reind:execute}
     <engine.n3>.log:semantics) log:conjunction :F.
   :F log:conclusion :G.
   :G log:includes { :x reind:execute ontd:File2 }.
    :y a ont:Service. :y ont:target :z. :z a ont:Fax.
} => { :x reina:ispermitted :y }.

#ends
