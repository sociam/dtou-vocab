# USAGE :  cwm --n3 requestB.n3 engine.n3 --think --filter="engine.n3"

@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix reinb: <reinB.n3#>.
@prefix reina: <reinA.n3#>.
@prefix rein: <rein.n3#>.
@prefix ont: <ontB.n3#>.
@prefix onta: <ontA.n3#>.
@prefix : <#>.

<> a reinb:Policy;
	rein:usesOntology <reinB.n3>;
        reinb:metameta reinb:CheckModalityFirst;
        reinb:modality reinb:Positive.

# All graduate students are permitted to use PrintingServices 
@forAll :x, :y.
{ ?x a ont:GradStudent. 
  ?y a ont:PrintService
} => { ?x reinb:pospermitted ?y }.


# No graduate student is permitted to use Flickr
@forAll :x.
{ ?x a ont:GradStudent
} => { ?x reinb:posprohibited ont:Flickr }.


# A professor is permitted to use any service on a printer located in DIG
@forAll :x, :y, :z.
{ ?x a ont:Prof. 
  ?y a ont:Printer. 
  ?y ont:locatedIn ont:Dig. 
  ?z ont:target ?y
} => { ?x reinb:pospermitted ?z }.


# A student is permitted to use any service on printers located in labs 
# that their advisor is affiliated to
@forAll :x, :y, :z, :p, :a.
{ ?x a ont:Student. 
  ?y ont:advises ?x. 
  ?y ont:affiliatedTo ?z. 
  ?p ont:locatedIn ?z. 
  ?a a ont:PrintService. 
  ?a ont:target ?p
} => { ?x reinb:pospermitted ?a }.


# if x is prohibited from using Flickr, he/she is permitted to use Call
@forAll :x.
{ ?x reinb:posprohibited ont:Flickr
} => { ?x reinb:pospermitted ont:Call }.


# all faculty are permitted to use Call
@forAll :x.
{ ?x a ont:Faculty
} => { ?x reinb:pospermitted ont:Call }.


# if a grad student of MIT is permitted by policyA to perform onta:UseHPFax Service, 
# then the student is permitted to perform Flickr service in MIT
@forAll :x, :F, :G.
{  :x a ont:MemberOfMIT. 
   # create a request object for using with engine.n3
   ( { [] a rein:Request; rein:requester :x; 
       rein:requestedAction onta:UseHPFax; rein:requestType reina:ispermitted }
     <engine.n3>.log:semantics) log:conjunction :F.
   :F log:conclusion :G.
   :G log:includes {:x reina:ispermitted onta:UseHPFax} 
} => { :x reinb:pospermitted ont:Flickr }.

#ends
